<html>
<head>
  <title></title>
</head>
<body>
  <h1></h1>
  

<p>An ARP spoofing experiment where the attacker puts himself in between two nodes and then modifies their traffic. There are two classes of experiments that need to be combined:
    a. an experiment where ARP poisoning happens between two nodes by the attacker
    b. an experiment where an attacker changes traffic passing through it</p>

<h1 id="example-3-arp-poisoning-with-mitm-attack:f010c5435eb4420a8497571ebde51c6d">Example 3: ARP poisoning with MITM attack</h1>

<p>This example used two metadescriptions. The first was ARP poisoning which is a flavor of cache poisoning, and the other is MITM attack. This example is written in [CurrentlyProposedLanguage].</p>

<h2 id="arp-poisoning-metadescription:f010c5435eb4420a8497571ebde51c6d">ARP poisoning metadescription</h2>

<p>This is a special case of cache poisoning where the target is ARP cache.</p>

<p><em>define ARPPoisoning: import cachePoisoning cp</em></p>

<p><em>Logical topology:</em></p>

<pre><code>*Objects:*

  IP := cp.Name, IP extends IPAddress

  fakePA := cp.fakeResource, fakePA extends MACAddress

  Cache := cp.Cache, Cache := {ARPRecord[] records}

*Cardinality:*

*Relationships:*
</code></pre>

<p>*Timeline of events: *</p>

<p><em>Definitions:</em></p>

<pre><code>Attacker a, IP ip, fakePA fpa, Cache c

  e1 :ARPREPLY, origin c, content fpa)}

  s1 := cp.s1
</code></pre>

<p><em>Timeline:</em></p>

<pre><code>  timeline(cp)
</code></pre>

<p><em>Invariants:</em> Nothing in addition to the topology and timeline above.</p>

<h2 id="mitm-attack-metadescription:f010c5435eb4420a8497571ebde51c6d">MITM attack metadescription</h2>

<p><em>define MITM:</em></p>

<p><em>Logical topology:</em></p>

<pre><code>*Objects:*

  Attacker, Node1, Node2 extends Node

*Cardinality:*

  |Attacker|,,1,,

  |Node1|,,1,,

  |Node2|,,1,,

*Relationships:*
</code></pre>

<p>*Timeline of events: *</p>

<p><em>&lsquo;Definitions:</em></p>

<pre><code>Attacker a, Node1 n1, Node2 n2

  e1 :MSG, origin a, content = x}

  e2 :MSG, origin n2, content = modify(x)}

  e3 :MSG, origin a, content = y}

  e4 :MSG, origin n1, content = modify(y)}
</code></pre>

<p><em>Timeline:</em></p>

<pre><code>  e1 -&gt; e2 and e3 -&gt; e4 
</code></pre>

<p><em>Invariants:</em>    Nothing in addition to the topology and timeline above.</p>

<h2 id="experiment-design:f010c5435eb4420a8497571ebde51c6d">Experiment design</h2>

<p>Now I&rsquo;m a user who wants to design an experiment. I need to combine two metadescriptions (ARP poisoning and MITM attack) and somehow tie them down to generator choices. To combine I&rsquo;ll do something like this:</p>

<p><em>define MITMwARP: import ARPPoisoning arp1, ARPPoisoning arp2, MITMAttack mitm</em></p>

<p><em>Logical topology:</em></p>

<pre><code>*Objects:*

  arp1.FakePA := mac(mitm.Attacker)

  arp1.IP := ip(mitm.Node2)

  arp2.fakePA := mac(mitm.Attacker)

  arp2.IP := ip(mitm.Node1)

*Cardinality:*

*Relationships:*

  collocated(arp1.Cache, mitm.Node1)    

  collocated(arp2.Cache, mitm.Node2)    
</code></pre>

<p>*Timeline of events: *</p>

<p><em>&lsquo;Definitions:</em></p>

<pre><code>(timeline(arp1) and timeline(arp2)) -&gt; timeline(mitm)
</code></pre>

<p><em>Timeline:</em></p>

<p><em>Invariants:</em>    Nothing in addition to the topology and timeline above.</p>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
