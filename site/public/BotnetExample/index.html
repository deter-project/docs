<html>
<head>
  <title></title>
</head>
<body>
  <h1></h1>
  

<p>A worm infects some vulnerable hosts, they organize into a P2P botnet with some botmaster and start exchanging C&amp;C traffic. Experimenter wants to observe the evolution of the botnet and the amount of traffic that master receives. There are two classes of experiments here that need to be combined together:
    a. an experiment where worm spreads and infects vulnerable hosts
    b. an experiment where some hosts organize into P2P network and somehow elect a leader who then sends commands to them and they may send reports back</p>

<h1 id="example-1-botnet:047fbe5fdb045045c26808c44256919d">Example 1: Botnet</h1>

<p>This example used two metadescriptions. Let&rsquo;s go through each of them. This example is written in [CurrentlyProposedLanguage].</p>

<h2 id="worm-spread-metadescription:047fbe5fdb045045c26808c44256919d">Worm spread metadescription</h2>

<p><em>define Worm:</em></p>

<p><em>Logical topology:</em></p>

<p><em>Objects:</em></p>

<pre><code>VNode extends Node

VNode :Vulnerable, Vulnerability vulnerability = x}

INode :Infected}
</code></pre>

<p><em>Cardinality:</em></p>

<pre><code>|INode|,,&gt;=1,,

|VNode|,,&gt;=1,,
</code></pre>

<p><em>Relationships:</em></p>

<p>*Timeline of events: *</p>

<p><em>Definitions:</em></p>

<pre><code> each Inode i, some VNode v:

   e1 :SCAN, origin v, vulnerability = x }

   s1 :Infected}
</code></pre>

<p><em>Timeline:</em></p>

<pre><code>   e1 -&gt; if (e1.vulnerability == v.vulnerability) then s1
</code></pre>

<p><em>Invariants:</em> No additional ones are needed here.</p>

<h2 id="p2p-w-leader-and-c-c-traffic-metadescription:047fbe5fdb045045c26808c44256919d">P2P w leader and C&amp;C traffic metadescription</h2>

<p><em>define P2P:</em></p>

<p><em>Logical topology:</em></p>

<p><em>Objects:</em></p>

<pre><code>Peer extends Node

Peer :{}, Leader leader = none }

Leader extends Peer

Leader :{}  }
</code></pre>

<p><em>Cardinality:</em></p>

<pre><code>|Peer|,,&gt;=2,,

|Leader|,,&gt;=1,,
</code></pre>

<p><em>Relationships:</em></p>

<p>*Timeline of events: *</p>

<p><em>Definitions:</em></p>

<pre><code>PEERREQUEST extends REQUEST

PEERREPLY extends REPLY

each Peer peer1, some Peer peer2: 

  e1 :PEERREQUEST, origin peer2}

  e2 :PEERREPLY, origin peer1}

  s1 := {peer2.peers += peer1}

  s2 := {peer2.peers += peer1}
</code></pre>

<p>each Peer x:</p>

<pre><code>  e3 :LEADERIS, origin x, Leader yourleader = leader}

  s3 :leader}

  e4 :HELLO, origin x.leader} 

  e5 :CMD, origin x, String cmd = c} 

  e6 :REPORT, origin x, String report = r} 
</code></pre>

<p><em>Timeline:</em></p>

<pre><code>  e1 -&gt; [s1 and (e2 | matches(e2,e1)) -&gt; s2] | | e3 -&gt; s3 -&gt; e4 -&gt; e5 -&gt; [e6]
</code></pre>

<p><em>Invariants:</em> No additional ones are needed here.</p>

<h2 id="experiment-design:047fbe5fdb045045c26808c44256919d">Experiment design</h2>

<p>Now I&rsquo;m a user who wants to design my experiment. I need to combine two metadescriptions and somehow tie them down to generator choices. To combine I need to specify how outputs of worm metadescription match inputs of P2P metadescription. I&rsquo;ll do something like this:</p>

<p><em>define Botnet: import Worm w, P2P p2p</em></p>

<p><em>Logical topology:</em></p>

<p><em>Objects:</em></p>

<pre><code>each p2p.Peer p and each w.Infected i

    p := i
</code></pre>

<p><em>Cardinality:</em></p>

<p><em>Relationships:</em></p>

<p>*Timeline of events: *</p>

<p><em>Definitions:</em></p>

<p><em>Timeline:</em></p>

<pre><code> timeline(w) | | timeline(p2p)
</code></pre>

<p><em>Invariants:</em> No additional ones are needed here.</p>

<p>i.e. each infected host becomes a peer.</p>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
