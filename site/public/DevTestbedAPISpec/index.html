<html>
<head>
  <title></title>
</head>
<body>
  <h1></h1>
  

<p>[[TOC]]</p>

<p>The DETER testbed API is broken up into services, each covering one of the major abstractions that the testbed exports.  The services are:</p>

<ul>
<li>Admin</li>
<li>ApiInfo</li>
<li>Users</li>
<li>Projects</li>
<li>Resources</li>
<li>Experiments</li>
<li>Libraries</li>
</ul>

<p>We discuss each in detail and provide links to the detailed javadoc of the implementation, where applicable and available.</p>

<p>The document and API are both works in progress and will be fleshed out and changed as the API is modified.</p>

<h1 id="general-info:6e1460e986ff9e833a415d97b4845c62">General Info</h1>

<p>The API is implemented as a SOAP web service over TLS secured connections.  The user&rsquo;s identity is generally provided by a client certificate, but the client certificates are generally transient.  A valid temporary client certificate can be requested from the API by correctly responding to a challenge keyed on the user&rsquo;s password.</p>

<p>The API is implemented using the axis web service framework, which means that javadocs are provided for the various calls.</p>

<p>Each service and call are accessed by appending servicename/operation to the base URL of the API server.  On DETERlab the base URL will be <a href="https://api.isi.deterlabnet:52323/axis2/service">https://api.isi.deterlabnet:52323/axis2/service</a>.  For example, one can access the getVersion operation below at <a href="https://api.isi.deterlabnet:52323/axis2/service/ApiInfo/getVersion">https://api.isi.deterlabnet:52323/axis2/service/ApiInfo/getVersion</a></p>

<p>Each operation returns useful parameters on success and throws a fault, called a DeterFault, on an error.  Faults are standard SOAP faults with a detail section that includes the following fields:</p>

<ul>
<li>ErrorCode - a 32-bit integer encoding the type of error.  Constants are available in the <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">the javadocs</a>.  Values are:

<ul>
<li>access - access denied</li>
<li>request - bad request</li>
<li>internal - internal server error</li>
<li>password - user has an expired password that must be changed</li>
<li>login - user is not logged in for a call that requires a valid login.</li>
</ul></li>
<li>ErrorString - a string describing the broad error</li>
<li>DetailString - a string describing the details that caused the error</li>
</ul>

<p>The <code>ErrorString</code> and <code>ErrorCode</code> are equivalent, but the information in the <code>DetailString</code> is generally more informative about the specifics.  Request or access errors are generally correctable on the client side while internal errors are not.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/DeterFault.html">javadoc for DeterFault</a></p>

<h1 id="apiinfo:6e1460e986ff9e833a415d97b4845c62">ApiInfo</h1>

<p>The ApiInfo service provides metadata about the running DETER API.  It also provides a simple check that a user is presenting authentication credentials correctly.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/ApiInfo.html">javadoc for ApiInfo</a></p>

<p>The primary operation in the ApiInfo service is <code>getVersion</code>.  The call is unauthenticated and can be made driectly from a web browser to confirm that the API is functioning and that the user can see DETERlab.</p>

<ul>
<li><em>Service:</em> ApiInfo</li>
<li><em>Operation:</em> getVersion</li>
<li><em>Input Parameters:</em>

<ul>
<li>None</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Version - A string containing the API version number</li>
<li>PatchLevel - A string containing the patch level</li>
<li>KeyID - A string.  If the user presented a valid public key and passed the SSL challenge, this is the sha1 hash of that key.  If no key was presented or an invalid one, this field is not returned.</li>
</ul></li>
</ul>

<p>There is an addtional simpler service, <code>echo</code>, that takes one parameter and returns it:</p>

<ul>
<li><em>Service:</em> ApiInfo</li>
<li><em>Operation:</em> echo</li>
<li><em>Input Parameters:</em>

<ul>
<li>param - a string to echo</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>the same string</li>
</ul></li>
</ul>

<h1 id="users:6e1460e986ff9e833a415d97b4845c62">Users</h1>

<p>The Users API is concerned with managing users and their profiles as well as authenticating to the testbed and receiving a client certificate for later calls.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/Users.html">javadoc for Users</a></p>

<h2 id="authentication:6e1460e986ff9e833a415d97b4845c62">Authentication</h2>

<p>A user&rsquo;s identity is tied to an X.509 client certifcate issued by DETER.  A certificate is bound to one user at a time, but a person can logout and log in as a different DETER user using the same certificate by presenting a different password, or logging out, which severs the connection of user to certificate.</p>

<p>A user can get a DETER-signed certificate by logging in without presenting an existing DETER-signed certificate.  For example, the first time a user logs in, they will get a DETER-signed certificate.</p>

<p>A UI is welcome to keep one certificate for a session, or to reuse the certificates until they expire.  The certificates are issued with several years of valid time.</p>

<p>A user can authenticate to the testbed and receive an X.509 certificate by requesting a challenge using the <code>requestChallenge</code> operation and responding to the challenge via the <code>challengeResponse</code> operation.</p>

<p>Currently only one challenge is available, type &ldquo;clear&rdquo;.  The challenge has no data and the user replies with their password in clear text.  Note that the exchange is protected by the SSL encrypted exchange, but implementors should not respond to clear challenges with parameters in the query string.  The &ldquo;masked&rdquo; challenge will address this issue shortly.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> requestChallenge</li>
<li><em>Input Parameters:</em>

<ul>
<li>userid - the identity to authenticate</li>
<li>types - a list of challenges that are acceptable to the user.  May be empty</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Type - the kind of challenge</li>
<li>Data - the data needed for the challenge</li>
<li>Validity - number of seconds the challenge may be responded to</li>
<li>ChallengeID - a 64-bit identifier that allows the server to validate the reply</li>
</ul></li>
</ul>

<p>Each challenge is valid for 2 minutes and are rate-limited.  Web interfaces should collect the password from the user before requesting a challenge from the API to avoid spurious timeouts.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> challengeResponse</li>
<li><em>Input Parameters:</em>

<ul>
<li>ResponseData - a binary string, the response to the challenge</li>
<li>ChallengeID - The 64-bit identifier of the challenge being responded to</li>
</ul></li>
<li><em>Return Values</em>:

<ul>
<li>Certificate - an optional  binary string containing a PEM-encoded X.509 certificate and private key. (Passed down the encrypted connection)  If the user presented a certificate on this connection, no credential is returned.</li>
</ul></li>
</ul>

<p>Any certificate returned by the challenge is signed by the testbed.</p>

<p>The binding between user and certificate lasts 24 hours.  It can be renewed by making another login exchange.  A UI may want to prompt a user to login again before the binding times out.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> logout</li>
<li><em>Input Parameters:</em>

<ul>
<li>None</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A boolean, true if the logout succeeded</li>
</ul></li>
</ul>

<p>Removes the user-to-certificate binding for this certificate.  The certificate can be reused or discarded, but cannot be used to manipulate the testbed without another successful requestChallenge/challengeResponse exchange.</p>

<h2 id="password-changes:6e1460e986ff9e833a415d97b4845c62">Password Changes</h2>

<p>The password is a unique user feature that is not in the profile because of its role in authentication.  When a user needs to change their password there are two API calls that can be used.</p>

<p>If the user knows their current (or expired) password, they can authenticate using the standard challenge response protocol and then call</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> changePassword</li>
<li><em>Input Parameters:</em>

<ul>
<li>uid - the userid to change (note that an admin may change others passwords)</li>
<li>newPass - the new passowrd</li>
</ul></li>
<li><em>Return Values</em>:

<ul>
<li>a boolean, true if successful, but errors will throw a fault</li>
</ul></li>
</ul>

<p>We expect that the web interface will handle issues like confirming user input to a password change page.  The changePassword call just makes the change directly.</p>

<p>If a user has forgotten their password, the user can request a password challenge, sent to them at their profile e-mail address.  The challenge is a 64-bit number that can be used to call changePasswordChallenge without logging in.  To request a challenge, the web interface calls:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> requestPasswordReset</li>
<li><em>Input Parameters:</em>

<ul>
<li>uid - the userid to change</li>
<li>urlPrefix - a string prefixed to the challenge ID in the mail sent to the user</li>
</ul></li>
<li><em>Return Values</em>:

<ul>
<li>a boolean, true if successful, but most errors will throw a fault</li>
</ul></li>
</ul>

<p>Again, we expect this call to generally be made from a web interface that will then want to present an input form to the in order to reset their password.  The urlPrefix field provides that hook.  A web interface running on !<a href="https://niftydeter.com">https://niftydeter.com</a> might call requestPasswordReset with parameters &lsquo;forgetfuluser&rsquo; and &lsquo;!<a href="https://niftydeter.com/reset.html?challenge='">https://niftydeter.com/reset.html?challenge='</a>.  After that call forgetfuluser will get e-mail asking him or her to access the web page at !<a href="https://niftydeter.com/reset.html?challenge=1283548127541824">https://niftydeter.com/reset.html?challenge=1283548127541824</a>, allowing <code>niftydeter.com</code> to present their password change interface, and do error checking, etc. on the new password.</p>

<p>Each challenge is valid for 2 hours, and they are rate-limited so only a few can be outstanding.</p>

<p>With a valid challenge in hand, the web interface can call</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> changePasswordChallenge</li>
<li><em>Input Parameters:</em>

<ul>
<li>challengeID - the 64-bit number from the e-mail</li>
<li>newPass - the new passowrd</li>
</ul></li>
<li><em>Return Values</em>:

<ul>
<li>a boolean, true if successful, but most errors will throw a fault</li>
</ul></li>
</ul>

<h2 id="profile-manipulation:6e1460e986ff9e833a415d97b4845c62">Profile Manipulation</h2>

<p>DETER keeps metadata about each user called a profile.  The API provides an authenticated user with several interfaces to query and modify their profile information.</p>

<p>In the API each element of profile data is represented as a structure with the following data in it:</p>

<ul>
<li>name of the element</li>
<li>type of the element

<ul>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
</ul></li>
<li>value(s) of the element</li>
<li>a flag set if the element is optional</li>
<li>A flag set if the field can be removed from the profile</li>
<li>a modification type: elements may be read/write, read-only (e.g., username) or write-only (e.g., some shared secret) (valid strings are at <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">the constants documentation.</a></li>
<li>a brief description of the field, intended to be presented by a web interface or other third party program</li>
<li>an ordering hint for web interfaces presenting the data to users, an integer</li>
<li>an optional length hint to give a web interface a hint as to how big an input field to present.  0 indicates no hint.</li>
</ul>

<p>To get a profile schema, for example to create an empty web page,</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> getProfileDescription</li>
<li><em>Input Parameters:</em></li>
<li><em>Return Values:</em>

<ul>
<li>Uid - always empty</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values at <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">javadoc as described above</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input firld should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>To read a user&rsquo;s profile (generally only users can read their own profile).</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> getUserProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>userid - a string naming the user to be retrieved</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Userid - the user whose profile is returned</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values at <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">javadoc as described above</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input field should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>Finally a user can modify a profile:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> changeUserProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user&rsquo;s profile to modify</li>
<li>A list of change requests. Each request contains

<ul>
<li>Name - the name of the field to change</li>
<li>Value - the new value of the field</li>
<li>Delete - a flag, if true delete the field rather than modify it</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing</li>
<li>Name - astring with the name of the field</li>
<li>Success - a flag indicating if the request succeeded</li>
<li>Reason - a string indicating the reason if Success is false</li>
</ul></li>
</ul>

<h2 id="notifications:6e1460e986ff9e833a415d97b4845c62">Notifications</h2>

<p>A notification is a short message from another user or the testbed asking a user to take an action (add someone to a project, update a password before expiration) or communicating other information to the user (testbed downtime, etc).  A web interface will want to present these to a user.</p>

<p>Each notification has a set of flags that define its state.  Currently there are 2</p>

<ul>
<li><em>READ</em> true if the user has read the notification</li>
<li>*URGENT*true if the testbed considers this urgent information</li>
</ul>

<p>The user is free to change this state using the markNotifications call.  Note that notifications are per-user.  A user who clears the READ or URGENT flag does not clear the flag for other recipients of the notification.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> getNotifications</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user&rsquo;s identity to gather notifications</li>
<li>FirstDate - an optional date.  If present only show notifications after that date</li>
<li>LastDate - an optional date.  If present only show notifications before that date</li>
<li>Flags - A potentially empty list of flags to check.  If a flag&rsquo;s name appears in this list, only notifications with their flag in the given state are returned.

<ul>
<li>Tag - a string, the name of the flag</li>
<li>isSet - a boolean, true if the flag should be set</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing

<ul>
<li>ID - a 64-bit integer identifying the notification</li>
<li>Flags - the notification state in the format</li>
<li>Tag - a string, the name of the flag</li>
<li>isSet - a boolean, true if notifications with the flag set should be returned, false if notifications with the flag unset should be returned</li>
<li>Sent - the date the notification was issued</li>
<li>Text - the text of the notification</li>
</ul></li>
</ul></li>
</ul>

<p>The filtering variables are all applied if given.</p>

<p>The mask and flags variable define the state a user is searching for.  If a bit is set in both mask and flags, only messages with that bit set are returned.  Similarly if a bit is clear in flags and set in mask, only messages with that bit clear will be returned.</p>

<p>To be concrete: a user who wants to retrieve all unread messages (urgent or not) should send a flags field with the READ bit clear and a mask with the READ bit set.  To retrieve only unread urgent messages, the flags should have READ clear and URGENT set, and both READ and URGENT set in the mask.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> markNotifications</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user&rsquo;s identity to gather notifications</li>
<li>Ids - an array of 64-bit integers, the identifiers of the notifications to mark</li>
<li>Flags - A list of flags to modify.  If a flag&rsquo;s name appears in this list, notifications will have their flag set to the given value.

<ul>
<li>Tag - a string, the name of the flag</li>
<li>isSet - a boolean, true if the flag should be set, false if it should be unset</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>Administrators can send notifications, for example to announce testbed events.  The call to do so is:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> sendNotification</li>
<li><em>Input Parameters:</em>

<ul>
<li>Users - a list of uids to receive the notification</li>
<li>Projects - a list of projects to receive the notification.  All users in the project will receive it</li>
<li>Flags - A list of initial flag values.  If a flag&rsquo;s name appears in this list, notifications will have their flag set to the given value.  Flags that do not appear will be unset.

<ul>
<li>Tag - a string, the name of the flag</li>
<li>isSet - a boolean, true if the flag should be set, false if it should be unset</li>
</ul></li>
<li>Text - the content of the notification</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<h2 id="creation-and-deletion:6e1460e986ff9e833a415d97b4845c62">Creation and Deletion</h2>

<p>Finally a user can request access to the testbed by creating a profile.  The user has no privileges and consumes minimal resources until they join a vetted project.  This is an unauthenticated call, but the user profile is not created until an automated e-mail exchange is made between the testbed and the proto-user.</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> createUser</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requested userid (optional)</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>StringValue - a string containing the element&rsquo;s value</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>The userid actually created</li>
</ul></li>
</ul>

<p>Note that all non-optional fields must be provided, so this is best preceeded by a call to getProfileDescription to learn the fields.</p>

<p>A base userid is constructed, either from the userid presented or from a required field in the profile.  If that base userid is available, that a user with that userid is created.  Otherwise the userid is disambiguated until there are no collisions.  The userid actually created is returned.</p>

<p>The user is created without membership in any projects and without a password.  A password reset challenge (equivalent to one issued by requestPasswordReset) is issued and the challenge e-mailed to the user at the address in the profile.</p>

<p>Administrators can create users without the confirmation step:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> createUserNoConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requested userid (optional)</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>StringValue - a string containing the element&rsquo;s value, unless it is binary/opaque</li>
</ul></li>
<li>clearpassword - an optional string given the cleartext password</li>
<li>hash - an optional string containing a hashed password</li>
<li>hashtype - an optional string giving the type of hash</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>The userid actually created</li>
</ul></li>
</ul>

<p>Note that either the cleartext password or the hash and type must be passed.  This interface is under for initializing the testbed or creating users in batch for something like a class.</p>

<p>Removing a user is accomplished using
* <em>Service:</em> Users
* <em>Operation:</em> removeUser
* <em>Input Parameters:</em>
   * Userid - the requested userid
* <em>Return Values:</em>
  * a boolean, true if the user was removed</p>

<p>Most users are unlikely to use this service, and policy may allow only administrators to remove users.</p>

<h2 id="manipulating-profile-attributes:6e1460e986ff9e833a415d97b4845c62">Manipulating Profile Attributes</h2>

<p>Administrators may add attributes to user profiles or remove them.  That is to say, add a schema (including format constraints and descriptions), not set a value for a user.</p>

<p>Creating an attribute:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> createUserAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
<li>Def - default value of the attribute (will be set for all users)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<p>And removing an attribute:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> removeUserAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was removed</li>
</ul></li>
</ul>

<p>Finally administrators can modify profile attributes:</p>

<ul>
<li><em>Service:</em> Users</li>
<li><em>Operation:</em> modifyUserAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<h1 id="projects:6e1460e986ff9e833a415d97b4845c62">Projects</h1>

<p>The profile API lets users manage their project memberships as well as manipulate projects.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/Projects.html">Projects javadocs</a></p>

<h2 id="listing-projects:6e1460e986ff9e833a415d97b4845c62">Listing Projects</h2>

<p>Authenticated users can look at the various projects they are members of, and may scope such searcher by project names.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> viewProjects</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requester&rsquo;s userid</li>
<li>Owner - a userid - only find projects owned by this user</li>
<li>NameRE - a string containing a regular expression to match against project names</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of project descriptors containing

<ul>
<li>Name - a string contaiing the project name</li>
<li>Owner - the uid of the project owner</li>
<li>Members - an array of structures containing</li>
<li>Userid - a member&rsquo;s userid</li>
<li>Permissions - a list of strings encoding the user&rsquo;s rights (each a flag, if present the user has the right)

<ul>
<li>ADD_USER - right to add a user to this project</li>
<li>REMOVE_USER - right to remove a user from this project</li>
<li>CREATE_CIRCLE - the right to create a circle under this project&rsquo;s name space</li>
</ul></li>
<li>Approved - a flag indicating this project has been approved</li>
</ul></li>
</ul></li>
</ul>

<p>Filters are cumulative: specifying a regular expression and an owner will match on both.</p>

<h2 id="changing-project-membership:6e1460e986ff9e833a415d97b4845c62">Changing Project Membership</h2>

<p>Each of these changes propagates to the linked circle that controls resource permissions for the project. In particular, the permissions fields should include the union of the project and circle rights to set</p>

<p>With appropriate rights a user can add another user to a project they are in.
The user being added must confirm this addition (below).  As a result of this call, users being added will be sent a notification including a challenge id to respond to, similar to a password change URL.  The prefix for that URL can be passed in here.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> addUsers</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectID - the project</li>
<li>Uids - the userids to add</li>
<li>Perms - a list of strings giving the permissions to grant the user in this project.  The values are the same as in viewProjects.</li>
<li>urlPrefix - a prefix to direct the user to a specific web interface to respond to the challenge.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>For each user successfully added, a notification is sent.  To respond to that notification the UI must call:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> addUserConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>ChallengeID - the challenge being responded to</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true if the user was added.  A fault is thrown on errors.</li>
</ul></li>
</ul>

<p>Once the confirmation is received, the user is actually a member of the project.  If challenges are not responded to in 48 hours, they are no longer valid.</p>

<p>Administrators can add users without going through the confirmation process:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> addUsersNoConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectID - the project</li>
<li>Uids - the userids to add</li>
<li>Perms - a list of strings that define the user&rsquo;s rights.  They are the same strings as in viewProjects.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>Users can also request to join a project.  This requires some member of the project with ADD_USER rights to agree, so a notification is sent to all such users.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> joinProject</li>
<li><em>Input Parameters:</em>

<ul>
<li>Uid - the uid to add</li>
<li>ProjectID - the project to join</li>
<li>urlPrefix - a prefix to direct the user to a specific web interface to respond to the challenge.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A boolean, true if the join request was sent</li>
</ul></li>
</ul>

<p>The join succeeds when a user with appropriate permissions calls joinProjectConfirm.
Note that the user calling joinProjectConfirm sets the new user&rsquo;s project permissions.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> joinProjectConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>ChallengeID - the challenge being responded to</li>
<li>Perms - a list of strings defining the permissions to grant the user in this project.  The values are as in viewProjects.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true if the user was successfully added.  A fault is thrown on errors.</li>
</ul></li>
</ul>

<p>Users can be removed from projects:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> removeUsers</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectName - the project to change</li>
<li>Uids - uids to remove</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>If a user has the right to both add and remove a user, that user can change a user&rsquo;s permissions:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> changePermissions</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectName - the project to change</li>
<li>Uids - the uids to manipulate</li>
<li>Permissions - a list of strings encoding the user&rsquo;s rights (each a flag - the user is assigned the right/permission if the string is present).  The values are as in viewProjects.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<h2 id="manipulating-projects:6e1460e986ff9e833a415d97b4845c62">Manipulating Projects</h2>

<p>The owner of a group (and only the owner of that group) can give that privilege away:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> setOwner</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requester&rsquo;s userid</li>
<li>ProjectName - the project to change</li>
<li>NewOwner - the uid of the new owner</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<h2 id="project-profiles:6e1460e986ff9e833a415d97b4845c62">Project Profiles</h2>

<p>The calls for manipulating a project profile are very similar to user profiles:</p>

<p>To get a profile schema, for example to create an empty web page,</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> getProfileDescription</li>
<li><em>Input Parameters:</em></li>
<li><em>Return Values:</em>

<ul>
<li>Projectid - always empty</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input firld should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>To read a project&rsquo;s profile.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> getProjectProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>Projectid - a string naming the project to be retrieved</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Projectid - the project whose profile is returned</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (Defined <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input field should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>Finally a user can modify a project profile:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> changeProjectProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectId - the project&rsquo;s profile to modify</li>
<li>A list of change requests. Each request contains

<ul>
<li>Name - the name of the field to change</li>
<li>Value - the new value of the field</li>
<li>Delete - a flag, if true delete the field rather than modify it</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing</li>
<li>Name - astring with the name of the field</li>
<li>Success - a flag indicating if the request succeeded</li>
<li>Reason - a string indicating the reason if Success is false</li>
</ul></li>
</ul>

<h2 id="manipulating-profile-attributes-1:6e1460e986ff9e833a415d97b4845c62">Manipulating Profile Attributes</h2>

<p>Administrators may add attributes to project profiles or remove them.  That is to say, add a schema (including format constraints and descriptions), not set a value for a project.</p>

<p>Creating an attribute:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> createProjectAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
<li>Def - default value of the attribute (will be set for all users)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<p>And removing an attribute:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> removeProjectAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was removed</li>
</ul></li>
</ul>

<p>Finally administrators can modify profile attributes:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> modifyProjectAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<h2 id="creating-and-deleting-projects:6e1460e986ff9e833a415d97b4845c62">Creating and Deleting Projects</h2>

<p>Creating and removing projects are also similar to creating and removing users:</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> createProject</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectId - the new project&rsquo;s name</li>
<li>Owner - the new owner&rsquo;s uid (usually the caller)</li>
<li>profile - a list of attributes that will make up the project&rsquo;s profile</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>StringValue - a string containing the element&rsquo;s value</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>As with users, all required (non-optional) fields in the profile must be provided.  The project will be created, but have no rights until approved.</p>

<p>On success the new project is created with the calling user as owner and sole member.  The user has all rights.</p>

<p>Approval is a result of the testbed&rsquo;s vetting process.  The user will be sent a notification when their project is approved.  When approved this call is made by an admin.</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> approveProject</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectID - the project&rsquo;s name</li>
<li>approved - a boolean, the new approval state</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>Note that this call can be used to un-approve a previously approved project.</p>

<p>Removing a project is straightforward</p>

<ul>
<li><em>Service:</em> Projects</li>
<li><em>Operation:</em> removeProject</li>
<li><em>Input Parameters:</em>

<ul>
<li>ProjectId - the requester&rsquo;s userid</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A boolean, true if the approval succeeded</li>
</ul></li>
</ul>

<p>Generally an removing a project requires a testbed administrator.</p>

<h1 id="circles:6e1460e986ff9e833a415d97b4845c62">Circles</h1>

<p>The circle API lets users manage their circle memberships as well as manipulate circles.  The circles API is similar to the Projects API.  The primary exceptions are that there is no approval process for circles (though there is for joining or adding a user) and that the permissions are different.</p>

<p>These calls work on all circles <em>except</em> those linked to a project.  Those circles must have their membership, ownership, and permissions manipulated through the project to ensure that the contents remain synchronized.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/Circles.html">circles javadoc</a></p>

<h2 id="listing-circles:6e1460e986ff9e833a415d97b4845c62">Listing Circles</h2>

<p>Authenticated users can look at the various circles they are members of, and may scope such searcher by circle names.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> viewCircles</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requester&rsquo;s userid</li>
<li>Owner - a userid - only find circles owned by this user</li>
<li>NameRE - a string containing a regular expression to match against circle names</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of circle descriptors containing

<ul>
<li>Name - a string contaiing the circle name</li>
<li>Owner - the uid of the circle owner</li>
<li>Members - an array of structures containing</li>
<li>Userid - a member&rsquo;s userid</li>
<li>permissions - a list of strings encoding the user&rsquo;s rights (each a flag - the user has the permission if the string is present)

<ul>
<li>ADD_USER - right to add a user to this circle</li>
<li>REMOVE_USER - right to remove a user from this circle</li>
<li>REALIZE_EXPERIMENT - the right to realize an experiment under this circle</li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<p>Filters are cumulative: specifying a regular expression and an owner will match on both.</p>

<h2 id="changing-circle-membership:6e1460e986ff9e833a415d97b4845c62">Changing Circle Membership</h2>

<p>With appropriate rights a user can add another user to a circle they are in.
The user being added must confirm this addition (below).  As a result of this call, users being added will be sent a notification including a challenge id to respond to, similar to a password change URL.  The prefix for that URL can be passed in here.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> addUsers</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleID - the circle</li>
<li>Uids - the userids to add</li>
<li>Perms - a list of strings that give the permissions to grant the user in this circle.  The values are the same as described in viewCircles.</li>
<li>urlPrefix - a prefix to direct the user to a specific web interface to respond to the challenge.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>For each user successfully added, a notification is sent.  To respond to that notification the UI must call:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> addUserConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>ChallengeID - the challenge being responded to</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true if the user was added.  A fault is thrown on errors.</li>
</ul></li>
</ul>

<p>Administrators can add users without going through the confirmation process:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> addUsersNoConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleID - the circle</li>
<li>Uids - the userids to add</li>
<li>Perms - a list of strings giving the permissions to grant the user in this circle.  The values are given the same as described in viewCircles.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>Users can also request to join a circle.  This requires some member of the circle with ADD_USER rights to agree, so a notification is sent to all such users.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> joinCircle</li>
<li><em>Input Parameters:</em>

<ul>
<li>Uid - the uid to add</li>
<li>CircleID - the circle to join</li>
<li>urlPrefix - a prefix to direct the user to a specific web interface to respond to the challenge.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A boolean, true if the join notification was sent</li>
</ul></li>
</ul>

<p>The join succeeds when a user with appropriate permissions calls joinCircleConfirm.
Note that the user calling joinCircleConfirm sets the new user&rsquo;s circle permissions.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> joinCircleConfirm</li>
<li><em>Input Parameters:</em>

<ul>
<li>ChallengeID - the challenge being responded to</li>
<li>Perms - a list of strings giving the permissions to grant the user in this circle.  The values are as described in viewCircles.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true if the user was subsequently added.  A fault is thrown on errors.</li>
</ul></li>
</ul>

<p>Users can be removed from circles:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> removeUsers</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleName - the circle to change</li>
<li>Uids - uids to remove</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<p>If a user has the right to both add and remove a user, that user can change a user&rsquo;s permissions:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> changePermissions</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleName - the circle to change</li>
<li>Uids - the uids to manipulate</li>
<li>Rights - a list of strings encoding the user&rsquo;s rights (each a flag).  Values are as given in viewCircles.  If the string is present, the user is granted the permission.</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of results of the form

<ul>
<li>Name - the uid being added</li>
<li>Success - a flag indicating success or failure</li>
<li>Reason - the reason for a failure</li>
</ul></li>
</ul></li>
</ul>

<h2 id="manipulating-circles:6e1460e986ff9e833a415d97b4845c62">Manipulating Circles</h2>

<p>The owner of a group (and only the owner of that group) can give that privilege away to another member:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> setOwner</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requester&rsquo;s userid</li>
<li>CircleName - the circle to change</li>
<li>NewOwner - the uid of the new owner</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<h2 id="circle-profiles:6e1460e986ff9e833a415d97b4845c62">Circle Profiles</h2>

<p>The calls for manipulating a circle profile are very similar to user profiles:</p>

<p>To get a profile schema, for example to create an empty web page,</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> getProfileDescription</li>
<li><em>Input Parameters:</em></li>
<li><em>Return Values:</em>

<ul>
<li>Circleid - always empty</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input firld should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>To read a circle&rsquo;s profile.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> getCircleProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>userid - a string naming the user to be retrieved</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Circleid - the user whose profile is returned</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string  describing the access values (values <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>READ_WRITE</li>
<li>READ_ONLY</li>
<li>WRITE_ONLY (e.g., password)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input field should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>Finally a user can modify a circle profile:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> changeCircleProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleId - the circle&rsquo;s profile to modify</li>
<li>A list of change requests. Each request contains

<ul>
<li>Name - the name of the field to change</li>
<li>Value - the new value of the field</li>
<li>Delete - a flag, if true delete the field rather than modify it</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing</li>
<li>Name - astring with the name of the field</li>
<li>Success - a flag indicating if the request succeeded</li>
<li>Reason - a string indicating the reason if Success is false</li>
</ul></li>
</ul>

<h2 id="manipulating-profile-attributes-2:6e1460e986ff9e833a415d97b4845c62">Manipulating Profile Attributes</h2>

<p>Administrators may add attributes to circle profiles or remove them.  That is to say, add a schema (including format constraints and descriptions), not set a value for a circle.
Creating an attribute:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> createCircleAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
<li>Def - default value of the attribute (will be set for all users)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<p>And removing an attribute:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> removeCircleAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was removed</li>
</ul></li>
</ul>

<p>Finally administrators can modify profile attributes:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> modifyCircleAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<h2 id="creating-and-deleting-circles:6e1460e986ff9e833a415d97b4845c62">Creating and Deleting Circles</h2>

<p>Creating and removing circles are also similar to creating and removing users:</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> createCircle</li>
<li><em>Input Parameters:</em>

<ul>
<li>CircleId - the new circle&rsquo;s name</li>
<li>Uid - the new owner&rsquo;s uid (usually the caller)</li>
<li>profile - a list of attributes that will make up the circle&rsquo;s profile</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>StringValue - a string containing the element&rsquo;s value</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>As with users, all required (non-optional) fields in the profile must be provided.  The circle will be created, and can be used immediately.</p>

<p>Removing a circle is straightforward.</p>

<ul>
<li><em>Service:</em> Circles</li>
<li><em>Operation:</em> removeCircle</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the requester&rsquo;s userid</li>
<li>Name - the new circle&rsquo;s name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<h1 id="experiments:6e1460e986ff9e833a415d97b4845c62">Experiments</h1>

<p>The experiment interface controls managing experiment definitions and realizing experiments (allocating and initializing resources). The experiment definition is in some flux, which is reflected in this section.</p>

<p>An experiment is a collection of aspects, each of which controls part of the experiment&rsquo;s environment and operation.  Some aspects are understood directly by the testbed, while others are interpreted and accessed by tolls inside the experiment.  Such tools may be written by DETER administrators or by experimenters themselves.</p>

<p>An <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/ExperimentAspect.html">aspect</a> is a named and typed object associated with the the experiment.  Specifically, an aspect has the following attributes:</p>

<p>name::
   A unique string scoped by aspect type used to identify the aspect instance
 type::
   A string that tells the testbed or tool how to interpret the aspect.  The current interface interprets <em>topology</em> aspects as an experiment layout, and treats the rest as opaque.
 subtype::
   A string characterizing the aspect further. Subtypes may be created by the testbed or tools.
 data::
   The contents of the aspect.  This will be empty if datareference has a value
 datareference::
   A URI that points to the contents of this aspect
 readOnly::
   A boolean, true if the aspect can be modified.</p>

<p>Each experiment also includes an access control list (ACL) that lists the permissions that members of a given circle are granted to this experiment.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/Experiments.html">experiments javadoc</a></p>

<h2 id="viewing-experiments:6e1460e986ff9e833a415d97b4845c62">Viewing Experiments</h2>

<p>One or more experiments can be viewed by an authorized user assuming that user has the proper permissions.  The search can be scoped by library and a regular expression matched against the experiment name.  In addition, the aspects returned and their contents can also be controlled.  To view experiments, call:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> viewExperiments</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - a string, if given return all experiments this user can see</li>
<li>Lib - a string, the name of a library.  Only experiments in that library will be returned</li>
<li>Regex - a string containing a regular expression matched against experiment names</li>
<li>QueryAspects - an array of aspects used to scope the aspect search  Each aspect has the fields described above.  The readOnly, data, and dataReference fields are all ignored.   If the name is present, it much match. If the type is given it must also match. If a type is given the subtype field further scopes the search. A missing subtype field selects aspects without any subtype. A specific subtype selects only aspects that match both type and subtype, and the distinguished value &ldquo;*&rdquo; matches any subtype. A subtype with a null type is invalid.</li>
<li>listOnly - a boolean, true if the aspects returned should not contain data.  This avoids unnecessary large data transfers</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>One or more structures with the following fields

<ul>
<li>Name - a string containing the experiment name</li>
<li>Owner - a string containing the owner&rsquo;s userid</li>
<li>Aspects - a list of aspect structures as defined above</li>
<li>ACL - a list of structures of the form</li>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.  Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
</ul></li>
</ul>

<h2 id="creating-and-deleting-experiments:6e1460e986ff9e833a415d97b4845c62">Creating and Deleting Experiments</h2>

<p>An experiment is created using:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> createExperiment</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing a new experiment&rsquo;s name</li>
<li>Userid - the user making the request (the owner on success)</li>
<li>Aspects - a list of aspects as defined above</li>
<li>AccessLists - a list of access list entries - a list of structures of the form

<ul>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
<li>Profile - a list of profile attribute value pairs</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the creation succeeded</li>
</ul></li>
</ul>

<p>Creating an experiment with one aspect may result in additional sub-aspects appearing, as well as modifications to other aspects.</p>

<p>An experiment is deleted using:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> removeExperiment</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment to delete</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true on success</li>
</ul></li>
</ul>

<p>After <code>removeExperiment</code> succeeds, experiment state is removed from the testbed completely.</p>

<h2 id="modifying-experiments:6e1460e986ff9e833a415d97b4845c62">Modifying Experiments</h2>

<p>Because aspects are somewhat free-form and can be interrelated, the interface for manipulating them is simple.  Aspects can be added and removed.</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> addExperimentAspects</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>Aspects - a list of aspects as defined above</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the addition succeeded</li>
</ul></li>
</ul>

<p>As with creation, adding an aspect may result in additional sub-aspects appearing, as well as modifications to other aspects.</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> removeExperimentAspects</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>Aspects - a list of aspects as defined above</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>
</ul>

<p>As with creation, adding an aspect may result in additional sub-aspects appearing, as well as modifications to other aspects.</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> addExperimentACL</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>AccessLists - a list of access list entries - a list of structures of the form

<ul>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>

<li><p><em>Service:</em> Experiments</p></li>

<li><p><em>Operation:</em> removeExperimentACL</p></li>

<li><p><em>Input Parameters:</em></p>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>AccessLists - a list circles to remove from the ACL</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>
</ul>

<p>The owner can give ownership to another user.</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> setOwner</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>newOwner - a string, the new owner&rsquo;s UID</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>
</ul>

<p>We expect to add filter-based interfaces in the future as well.</p>

<h2 id="realizing-and-releasing-experiments:6e1460e986ff9e833a415d97b4845c62">Realizing and Releasing Experiments</h2>

<p>To realize an experiment use:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> realizeExperiment</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Owner - the experiment owner</li>
<li>Name - a string containing the experiment to realize</li>
<li>Notify - a flag, if true send the user a notification when realization is complete</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>The user can either poll the experiment using <code>viewExperiments</code> and examining the <code>StateDetail</code> field or poll for a notification that the realization is complete.</p>

<p>If the realization fails - as indicated by the <code>State</code> variable in a <code>viewExperiments</code> response, the <code>Log</code> and <code>FaultInfo</code> fields characterize the error.</p>

<p>To release an experiment&rsquo;s resources:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> releaseExperiment</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Owner - the experiment owner</li>
<li>Name - a string containing the experiment to release</li>
<li>Notify - a flag, if true send the user a notification when realization is complete</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>None</li>
</ul></li>
</ul>

<p>After <code>releaseExperiment</code> succeeds, experiment state remains in the testbed, but containers are stopped and resources are returned to the testbed.</p>

<h2 id="experiment-profiles:6e1460e986ff9e833a415d97b4845c62">Experiment Profiles</h2>

<p>Experiments have profiles attached to them, as users, circles, and projects do.  Information in a profile is metadata about the experiment, intended for human consumption.  This is in opposition to an aspect which is intended for the testbed or experiment infrastructure to interpret.</p>

<p>The calls for manipulating an experiment profile are very similar to other profiles:</p>

<p>To get a profile schema, for example to create an empty web page,</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> getProfileDescription</li>
<li><em>Input Parameters:</em></li>
<li><em>Return Values:</em>

<ul>
<li>ExperimentId - always empty</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input firld should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>To read an experiment&rsquo;s profile.</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> getExperimentProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>eid - a string naming the experiment to be retrieved</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>ExperimentId - the experiment whose profile is returned</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (Defined <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input field should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>Finally a user can modify an experiment profile:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> changeExperimentProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>Eid - the experiment&rsquo;s profile to modify</li>
<li>A list of change requests. Each request contains

<ul>
<li>Name - the name of the field to change</li>
<li>Value - the new value of the field</li>
<li>Delete - a flag, if true delete the field rather than modify it</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing</li>
<li>Name - astring with the name of the field</li>
<li>Success - a flag indicating if the request succeeded</li>
<li>Reason - a string indicating the reason if Success is false</li>
</ul></li>
</ul>

<h2 id="manipulating-profile-attributes-3:6e1460e986ff9e833a415d97b4845c62">Manipulating Profile Attributes</h2>

<p>Administrators may add attributes to experiment profiles or remove them.  That is to say, add a schema (including format constraints and descriptions), not set a value for an experiment.</p>

<p>Creating an attribute:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> createExperimentAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
<li>Def - default value of the attribute (will be set for all users)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<p>And removing an attribute:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> removeExperimentAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was removed</li>
</ul></li>
</ul>

<p>Finally administrators can modify profile attributes:</p>

<ul>
<li><em>Service:</em> Experiments</li>
<li><em>Operation:</em> modifyExperimentAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<h1 id="libraries:6e1460e986ff9e833a415d97b4845c62">Libraries</h1>

<p>The library interface controls managing library contents. The experiment definition is in some flux, which is reflected in this section.</p>

<p>An library is a collection of experiments, each of which can be manipulated by users with the proper permissions.  By grouping experiments it is easier to collaborate on the experiments as well as providing pools of experiments to use as starting points for new users.</p>

<p>Each library includes an access control list (ACL) that lists the permissions that mebmers of a given circle are granted to the library.</p>

<h2 id="viewing-libraries:6e1460e986ff9e833a415d97b4845c62">Viewing Libraries</h2>

<p>One or more libraried can be viewed by an authorized user assuming that user has the proper permissions.  The search can be a regular expression matched against the library name.  To view libraries, call:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> viewLibraries</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - a string, if given return all experiments this user can see</li>
<li>Regex - a string containing a regular expression matched against experiment names</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>One or more structures with the following fields

<ul>
<li>Name - a string containing the experiment name</li>
<li>Owner - a string containing the owner&rsquo;s userid</li>
<li>Experiments - a list of experiment names</li>
<li>ACL - a list of structures of the form</li>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.  Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
</ul></li>
</ul>

<h2 id="creating-and-deleting-libraries:6e1460e986ff9e833a415d97b4845c62">Creating and Deleting Libraries</h2>

<p>A library is created using:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> createLibrary</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing a new experiment&rsquo;s name</li>
<li>Userid - the user making the request (the owner on success)</li>
<li>Experiments - a list of experiments in the library</li>
<li>AccessLists - a list of access list entries - a list of structures of the form

<ul>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
<li>Profile - a list of profile attribute value pairs</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the creation succeeded</li>
</ul></li>
</ul>

<p>A library is deleted using:</p>

<ul>
<li><em>Service:</em> Library</li>
<li><em>Operation:</em> removeLibrary</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the library to delete</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true on success</li>
</ul></li>
</ul>

<p>After <code>removeLibrary</code> succeeds, library is removed from the testbed completely.</p>

<h2 id="modifying-libraries:6e1460e986ff9e833a415d97b4845c62">Modifying Libraries</h2>

<p>Experiments can be added and removed from libraries</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> addLibraryExperiment</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the library&rsquo;s name</li>
<li>Experiments - a list of experiment names</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the addition succeeded</li>
</ul></li>
</ul>

<p>As with creation, adding an aspect may result in additional sub-aspects appearing, as well as modifications to other aspects.</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> removeLibraryExperiments</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>Experiments - a list of experiments to remove</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>

<li><p><em>Service:</em> Libraires</p></li>

<li><p><em>Operation:</em> addLibraryACL</p></li>

<li><p><em>Input Parameters:</em></p>

<ul>
<li>Name - a string containing the library&rsquo;s name</li>
<li>AccessLists - a list of access list entries - a list of structures of the form

<ul>
<li>Name - a string the circle name</li>
<li>Permissions - a list of strings containing this circle&rsquo;s permissions.Permissions are from <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html#net.deterlab.testbed.api.Permissions">this table</a></li>
</ul></li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>

<li><p><em>Service:</em> Libraries</p></li>

<li><p><em>Operation:</em> removeLibraryACL</p></li>

<li><p><em>Input Parameters:</em></p>

<ul>
<li>Name - a string containing the library&rsquo;s name</li>
<li>AccessLists - a list circles to remove from the ACL</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>
</ul>

<p>The owner can give ownership to another user.</p>

<ul>
<li><em>Service:</em> Library</li>
<li><em>Operation:</em> setOwner</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - a string containing the experiment&rsquo;s name</li>
<li>newOwner - a string, the new owner&rsquo;s UID</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the removal succeeded</li>
</ul></li>
</ul>

<h2 id="library-profiles:6e1460e986ff9e833a415d97b4845c62">Library Profiles</h2>

<p>Libraries have profiles attached to them, as users, circles, and projects do.  Information in a profile is metadata about the library, intended for human consumption.</p>

<p>The calls for manipulating a library profile are very similar to other profiles:</p>

<p>To get a profile schema, for example to create an empty web page,</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> getProfileDescription</li>
<li><em>Input Parameters:</em></li>
<li><em>Return Values:</em>

<ul>
<li>LibraryId - always empty</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (values <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input firld should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>To read a library&rsquo;s profile.</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> getLibraryProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>libid - a string naming the library to be retrieved</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>LibraryId - the experiment whose profile is returned</li>
<li>A list of profile elements each containing

<ul>
<li>Name - a string, the element&rsquo;s name</li>
<li>DataType - a string giving the element&rsquo;s</li>
<li>string</li>
<li>integer</li>
<li>double</li>
<li>binary/opaque</li>
<li>Value - a string containing the element&rsquo;s value</li>
<li>Access - a string describing the access values (Defined <a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/constant-values.html">here</a>)</li>
<li>Optional - a flag true if the field is optional (must be present but may be empty)</li>
<li>Removable - a flag true if the field can be removed</li>
<li>Description - a string explaining the field</li>
<li>Format - a regular expression that can be used to validate the field entry (may be null, and generally is for optional fields)</li>
<li>FormatDescription - A brief, natural language description of the field input constraints, e.g. &ldquo;A valid e-mail address&rdquo; or &ldquo;only numbers and spaces&rdquo;.</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input field should be presented</li>
</ul></li>
</ul></li>
</ul>

<p>Finally a user can modify a library profile:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> changeLibraryProfile</li>
<li><em>Input Parameters:</em>

<ul>
<li>Libid - the library&rsquo;s profile to modify</li>
<li>A list of change requests. Each request contains

<ul>
<li>Name - the name of the field to change</li>
<li>Value - the new value of the field</li>
<li>Delete - a flag, if true delete the field rather than modify it</li>
</ul></li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>A list of responses each containing</li>
<li>Name - astring with the name of the field</li>
<li>Success - a flag indicating if the request succeeded</li>
<li>Reason - a string indicating the reason if Success is false</li>
</ul></li>
</ul>

<h2 id="manipulating-profile-attributes-4:6e1460e986ff9e833a415d97b4845c62">Manipulating Profile Attributes</h2>

<p>Administrators may add attributes to library profiles or remove them.  That is to say, add a schema (including format constraints and descriptions), not set a value for a library.</p>

<p>Creating an attribute:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> createLibraryAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
<li>Def - default value of the attribute (will be set for all users)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was created</li>
</ul></li>
</ul>

<p>And removing an attribute:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> removeLibraryAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was removed</li>
</ul></li>
</ul>

<p>Finally administrators can modify profile attributes:</p>

<ul>
<li><em>Service:</em> Libraries</li>
<li><em>Operation:</em> modifyLibraryAttribute</li>
<li><em>Input Parameters:</em>

<ul>
<li>Name - the attribute name</li>
<li>Type - the type (STRING, INT, FLOAT, OPAQUE)</li>
<li>Optional - a boolean, true if this attribute is optional</li>
<li>Access - a string: the user&rsquo;s ability to modify (READ_WRITE, READ_ONLY, WRITE_ONLY, NO_ACCESS)</li>
<li>Description - natural language description of the field (optional)</li>
<li>Format - a regular expression describing the format (optional)</li>
<li>Formatdescription - a natural language explanation of the format (optional)</li>
<li>OrderingHint - an integer suggesting where to present the attribute. Lower numbers come first</li>
<li>LengthHint - an integer suggesting how long an input</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if the attribute was modified</li>
</ul></li>
</ul>

<h1 id="admin:6e1460e986ff9e833a415d97b4845c62">Admin</h1>

<p>The Admin service allows testbed administrators to manipulate the implementation internals and to initialize the testbed.  Most users will use this interface.  This section is provided out of order for completeness.</p>

<p><a href="http://www.isi.edu/~faber/tmp/DeterAPI/doc/net/deterlab/testbed/api/Admin.html">javadocs for Admin</a></p>

<p>The various permissions described in this document are also installed in the implementation&rsquo;s database.  It is possible to add new permissions while the system is running using the addPermission call.  The name of a permission is a string (scoped by the object).  Objects include circle, library, experiment, and project.</p>

<ul>
<li><em>Service:</em> Admin</li>
<li><em>Operation:</em> addPermission</li>
<li><em>Input Parameters:</em>

<ul>
<li>name - the name of the permission to add (string)</li>
<li>object - the object type for which it is valid (string)</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>a boolean, true if successful</li>
</ul></li>
</ul>

<p>The bootstrap call initializes an empty system and adds a user with full administrative power.  This only works if no admin project exists and no <em>deterboss</em> user exists.  It also creates a regression project for testing.  It returns the userid and password of the new admin user (always deterboss).</p>

<ul>
<li><em>Service:</em> Admin</li>
<li><em>Operation:</em> bootstrap</li>
<li><em>Input Parameters:</em>

<ul>
<li>none</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>bootstrap user (string)</li>
<li>bootstrap password (string)</li>
</ul></li>
</ul>

<p>The clearCredentialCache() call removes any cached credentials from the system.</p>

<ul>
<li><em>Service:</em> Admin</li>
<li><em>Operation:</em> clearCredentialCache</li>
<li><em>Input Parameters:</em>

<ul>
<li>none</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true on success</li>
</ul></li>
</ul>

<p>There are simple timers inserted in the code at times.  One can access their values and reset them using:</p>

<ul>
<li><em>Service:</em> Admin</li>
<li><em>Operation:</em> getTimerValues</li>
<li><em>Input Parameters:</em>

<ul>
<li>a list of timer names (may be empty)</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>A list of pairs of</li>
<li>timer name (string)</li>
<li>timer total (64-bit integer) elapsed time since started</li>
</ul></li>

<li><p><em>Service:</em> Admin</p></li>

<li><p><em>Operation:</em> removeTimers</p></li>

<li><p><em>Input Parameters:</em></p>

<ul>
<li>a list of timer names (may be empty)</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>true on success</li>
</ul></li>
</ul>

<p>If the policy databases have changed, administrators can reset the underlying policy and credential database using</p>

<ul>
<li><em>Service:</em> Admin</li>
<li><em>Operation:</em> resetAccessControl</li>
<li><em>Input Parameters:</em>

<ul>
<li>none</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>true on success</li>
</ul></li>
</ul>

<p>This can be a time-consuming operation.</p>

<h1 id="resources:6e1460e986ff9e833a415d97b4845c62">Resources</h1>

<p>Resources are things that make up experiments.  There are several specialized resources used in experimentation that have their own suite of operations, and there is a general set of operations for future expansion.</p>

<h2 id="computers:6e1460e986ff9e833a415d97b4845c62">Computers</h2>

<p>Computers are the physical computing resources of the testbed.  A user may be interested in specific instances of a computer - <code>pc23</code> - or in information about types or classes of computers.  Both are possible to view with these calls.</p>

<p>A user can view computers or classes by:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> viewComputers</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Owner - an optional string the computer owner</li>
<li>NameRE - an optional string containing a regular expression matched against the name</li>
<li>Type - an optional string containing the computer types to look for</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Zero or more structures with the following fields:

<ul>
<li>Name - a string, the name of this computer, if absent this is a class</li>
<li>Owner - a string, the owner of the computer or class</li>
<li>Type - a string containing the type of computer</li>
<li>Description - a string describing this computer or class</li>
<li>Allocated - an optional flag indicating whether this computer is allocated.  The field is absent all together if this structure describes a class</li>
<li>AllocatedExperiment - an optional string containing the experiment name if the computer is allocated and the user has the right to read the experiment</li>
<li>AllocatedProject - an optional string containing the project name in which the experiment is realized if the computer is allocated and the user has the right to read the project</li>
<li>ProjectDelete - an optional list of project names that can delete this resource</li>
<li>ProjectModify - an optional list of project names that can modify this resource</li>
<li>ProjectUse - an optional list of project names that can use this resource</li>
<li>ProjectRead - an optional list of projects names that can read this resource</li>
</ul></li>
</ul></li>
</ul>

<p>If any of the permission fields are not present, the class permissions apply.  If they are present for a specific computer, they specific computer&rsquo;s permissions override the class permissions.</p>

<p>Administrators can add new computers or classes using</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> createComputer</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Name - an optional string, the name of this computer, if absent this is a class</li>
<li>Type - a string containing the type of computer</li>
<li>Description - an optional string describing this computer or class (If omitted for a computer, the type description is used)</li>
<li>ProjectDelete - an optional list of project names that can delete this resource</li>
<li>ProjectModify - an optional list of project names that can modify this resource</li>
<li>ProjectUse - an optional list of project names that can use this resource</li>
<li>ProjectRead - an optional list of projects names that can read this resource</li>
</ul></li>
<li><em>Return Values:</em>
None</li>
</ul>

<p>Note that missing fields in a computer creation are generally filled in from the type.  Creating a computer or class without any projects that can use it is of questionable value.</p>

<p>Similarly, they can modify an existing computer using (assuming they are in a project that allows modification of the class or computer):</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> modifyComputer</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request</li>
<li>Name - an optional string, the name of this computer, if absent this is a class</li>
<li>Type - an optional string containing the type of computer</li>
<li>Description - an optional string describing this computer or class (If omitted for a computer, the type description is used)</li>
<li>ProjectDelete - an optional list of project names that can delete this resource</li>
<li>ProjectModify - an optional list of project names that can modify this resource</li>
<li>ProjectUse - an optional list of project names that can use this resource</li>
<li>ProjectRead - an optional list of projects names that can read this resource</li>
</ul></li>
<li><em>Return Values:</em>
None</li>
</ul>

<p>Values passed in overwrite the current values if the user had modify rights.  One of Name or Type must be present.</p>

<p>Finally an administrator can delete a computer:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> removeComputer</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request</li>
<li>Name - an optional string, the name of this computer, if absent this is a class</li>
<li>Type - an optional string, the type of computer.  May be omitted for specific computers</li>
</ul></li>
<li><em>Return Values:</em>
None</li>
</ul>

<h2 id="images:6e1460e986ff9e833a415d97b4845c62">Images</h2>

<p>Images are saved container state - including saved physical container state.  These are selected in the experiment definition, but users may need to manipulate them directly.</p>

<p>To read image information:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> viewImages</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Owner - an optional string the computer owner</li>
<li>NameRE - an optional string containing a regular expression matched against the name</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Zero or more structures with the following fields:

<ul>
<li>Name - a string, the name of this image</li>
<li>Owner - a string, the owner of the image</li>
<li>Description - a string describing this image</li>
<li>ValidIn - a list of container types that can use this image</li>
<li>ProjectDelete - a list of project names that can delete this resource</li>
<li>ProjectModify - a list of project names that can modify this resource</li>
<li>ProjectUse - a list of project names that can use this resource</li>
<li>ProjectRead - a list of projects names that can read this resource</li>
</ul></li>
</ul></li>
</ul>

<p>Images are created by operations on a container, but users can modify or delete their metadata:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> modifyImage</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request</li>
<li>Name - a string, the name of this image</li>
<li>Description - an optional string describing this computer or class</li>
<li>ValidIn - an optional list of container types that can use this image</li>
<li>ProjectDelete - an optional list of project names that can delete this resource</li>
<li>ProjectModify - an optional list of project names that can modify this resource</li>
<li>ProjectUse - an optional list of project names that can use this resource</li>
<li>ProjectRead - an optional list of projects names that can read this resource</li>
</ul></li>
<li><em>Return Values:</em>
None</li>
</ul>

<p>As with other resources, these values overwrite the existing parameters (except for name which is a selector).</p>

<p>A user can delete an image:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> removeImage</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Name - a string, the image to remove</li>
</ul></li>
<li><em>Return Values:</em>
None</li>
</ul>

<h2 id="pubkey:6e1460e986ff9e833a415d97b4845c62">Pubkey</h2>

<p>Public/Private keypairs are used several places in the testbed for authentication and access.  For example, access to containers that present a computer interface is done using the ssh protocol.  These interfaces allow users to manipulate their keys.</p>

<p>Viewing keys:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> viewKeys</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request</li>
<li>Owner - an optional string the computer owner</li>
<li>type - an optional string containing the kind of keys to report</li>
</ul></li>
<li><em>Return Values:</em>

<ul>
<li>Zero or more structures with the following fields:

<ul>
<li>Name - a string, the name of this key</li>
<li>Owner - a string, the owner of the key</li>
<li>Description - a string describing this key</li>
<li>KeyData - an opaque data value - the key data</li>
<li>ProjectDelete - a list of project names that can delete this resource</li>
<li>ProjectModify - a list of project names that can modify this resource</li>
<li>ProjectUse - a list of project names that can use this resource</li>
<li>ProjectRead - a list of projects names that can read this resource</li>
</ul></li>
</ul></li>
</ul>

<p>Users can add and delete keys:</p>

<ul>
<li><em>Service:</em> Resources</li>
<li><em>Operation:</em> addKey</li>
<li><em>Input Parameters:</em>

<ul>
<li>Userid - the user making the request (the owner on success)</li>
<li>Owner - an optional string the computer owner</li>
<li>Name - an optional string, the name of this key (system will assign if omitted)</li>
<li>Description - an optional string describing this key</li>
<li>KeyData - an opaque data value - the key data</li>
<li>ProjectDelete - a list of project names that can delete this resource</li>
<li>ProjectModify - a list of project names that can modify this resource</li>
<li>ProjectUse - a list of project names that can use this resource</li>
<li>ProjectRead - a list of projects names that can read this resource</li>
</ul></li>

<li><p><em>Return Values:</em></p>

<ul>
<li>None</li>
</ul></li>

<li><p><em>Service:</em> Resources</p></li>

<li><p><em>Operation:</em> removeKey</p></li>

<li><p><em>Input Parameters:</em></p>

<ul>
<li>Userid - the user making the request</li>
<li>Name - a string, the name of this key</li>
</ul></li>
</ul>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
